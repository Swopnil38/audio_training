{% extends 'base.html' %}

{% block title %}Upload Audio - Nepali + English ASR{% endblock %}

{% block container_class %}-sm{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="page-header">
    <h2>Upload or Record Audio</h2>
    <p>Add Nepali, English, or mixed audio for transcription</p>
</div>

<!-- Status Messages -->
<div id="statusSection" class="alert hidden"></div>

<!-- Main Card -->
<div class="card">
    <!-- Recording Section -->
    <div class="text-center">
        <button id="recordBtn" class="record-btn idle" type="button">
            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/>
                <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                <line x1="12" x2="12" y1="19" y2="22"/>
            </svg>
        </button>
        <div id="recordDuration" class="record-duration hidden">0:00</div>
    </div>
    
    <!-- Waveform Animation -->
    <div id="waveform" class="waveform hidden">
        <div class="waveform-bar"></div>
        <div class="waveform-bar"></div>
        <div class="waveform-bar"></div>
        <div class="waveform-bar"></div>
        <div class="waveform-bar"></div>
    </div>
    
    <!-- Divider -->
    <div class="divider">
        <span>or upload a file</span>
    </div>
    
    <!-- Dropzone -->
    <div id="dropzone" class="dropzone">
        <svg class="dropzone-icon" xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="17 8 12 3 7 8"/>
            <line x1="12" x2="12" y1="3" y2="15"/>
        </svg>
        <p>Drag & drop audio file, or click to browse</p>
        <small>MP3, WAV, OGG, FLAC, M4A, WebM (max 100MB)</small>
    </div>
    <input type="file" id="fileInput" accept="audio/*" class="hidden">
    
    <!-- File Preview -->
    <div id="previewSection" class="file-preview hidden">
        <div class="file-info">
            <div class="file-name">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3"/>
                    <polyline points="14 2 14 7 19 7"/>
                    <path d="M10 20v-1a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0Z"/>
                    <path d="M6 20v-1a2 2 0 1 0-4 0v1a2 2 0 1 0 4 0Z"/>
                    <path d="M2 19v-3a6 6 0 0 1 12 0v3"/>
                </svg>
                <span id="fileName"></span>
            </div>
            <button id="clearBtn" class="btn-icon" type="button">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M18 6 6 18"/><path d="m6 6 12 12"/>
                </svg>
            </button>
        </div>
        
        <!-- Audio Preview Player -->
        <audio id="audioPreview" controls></audio>
        
        <!-- Options -->
        <div class="grid-2">
            <div class="form-group">
                <label class="form-label">Language</label>
                <select id="language" class="form-select">
                    <option value="mixed">Mixed (Nepali + English)</option>
                    <option value="ne">Nepali Only</option>
                    <option value="en">English Only</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Title (optional)</label>
                <input type="text" id="title" class="form-input" placeholder="Enter title...">
            </div>
        </div>
        
        <!-- Upload Button -->
        <button id="uploadBtn" class="btn btn-primary btn-block btn-lg" type="button">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17 8 12 3 7 8"/>
                <line x1="12" x2="12" y1="3" y2="15"/>
            </svg>
            Upload & Transcribe
        </button>
    </div>
</div>
{% endblock %}
