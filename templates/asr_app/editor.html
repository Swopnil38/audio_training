{% extends 'base.html' %}

{% block title %}Editor - {{ audio_file.title|default:audio_file.original_filename }} - Nepali + English ASR{% endblock %}

{% block content %}
<div id="editorPage" data-audio-id="{{ audio_file.id }}">
    <!-- Editor Header -->
    <div class="editor-header">
        <div class="editor-title">
            <a href="{% url 'audiofile-list' %}" class="btn-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>
                </svg>
            </a>
            <div>
                <h2>{{ audio_file.title|default:audio_file.original_filename }}</h2>
                <p>{{ audio_file.segments.count }} segments</p>
            </div>
        </div>
        
        <div class="editor-progress">
            <div class="editor-progress-text">
                <span>Corrected</span><br>
                <strong><span id="correctedCount">0</span>/<span id="totalCount">0</span></strong>
            </div>
            <div class="progress-ring">
                <div id="progressRing" class="progress-ring-fill" style="width: 0%;"></div>
            </div>
        </div>
    </div>
    
    <!-- Audio Player -->
    <div class="card card-sm player-card">
        <audio id="audioPlayer" preload="metadata"></audio>
        
        <div class="player-controls">
            <button id="skipBack" class="btn-icon" title="Back 5s">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="19 20 9 12 19 4 19 20"/><line x1="5" x2="5" y1="19" y2="5"/>
                </svg>
            </button>
            
            <button id="playBtn" class="play-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="6 3 20 12 6 21 6 3"/>
                </svg>
            </button>
            
            <button id="skipForward" class="btn-icon" title="Forward 5s">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="5 4 15 12 5 20 5 4"/><line x1="19" x2="19" y1="5" y2="19"/>
                </svg>
            </button>
            
            <span id="timeDisplay" class="time-display">0:00.00 / 0:00.00</span>
            
            <div id="progressTrack" class="progress-track">
                <div id="progressFill" class="progress-fill"></div>
            </div>
        </div>
    </div>
    
    <!-- Segment List -->
    <div id="segmentList" class="segment-list">
        <!-- Populated by JavaScript -->
        <div class="text-center" style="padding: 3rem;">
            <div class="spinner spinner-lg" style="margin: 0 auto;"></div>
            <p class="mt-4" style="color: var(--text-muted);">Loading segments...</p>
        </div>
    </div>
</div>
{% endblock %}
